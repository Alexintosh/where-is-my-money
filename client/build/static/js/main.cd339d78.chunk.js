(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{230:function(e,t,a){e.exports=a(760)},265:function(e,t){},267:function(e,t){},356:function(e,t){},400:function(e,t){},402:function(e,t){},433:function(e,t){},760:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),c=a(223),o=a.n(c),r=a(227),s=a(39),d=a(19),i=a.n(d),m=a(120),u=a(79),p=a(80),E=a(82),b=a(81),h=a(83),f=a(48),v=a.n(f),g=a(61),y=a.n(g),w=[{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],type:"function"}],N=a(224),k=a.n(N),x={address:"0xd26114cd6EE289AccF82350c8d8487fedB8A0C07",logoUri:"https://gnosis-safe-token-logos.s3.amazonaws.com/0xd26114cd6EE289AccF82350c8d8487fedB8A0C07.png",default:!1,name:"OMG",symbol:"OMG",description:"OmiseGO (OMG) is a public Ethereum-based financial technology for use in mainstream digital wallets",decimals:18,websiteUri:"https://omisego.network",gas:!1,priceOracles:[]},A=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(a=Object(E.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(l)))).state={snippets:[],walletAddress:null,tokens:[]},a.getDataFromDb=function(){return fetch("api/getSnippets").then(function(e){return e.json()}).then(function(e){return e.data.filter(function(e){return e.upvotes>=e.downvotes})}).then(function(e){return a.setState({snippets:e})})},a.handleScan=function(e){if(e){var t=e.replace("ethereum:","");a.setState({customWalletAddress:t}),window.$("#QR").modal("hide"),a.resolveCustomWalletAddress(t)}},a.handleError=function(e){console.error(e)},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.getDataFromDb(),a=this.loadWalletAddress().then(function(t){e.setState({walletAddress:t,customWalletAddress:t})}),n=this.loadTokens().then(function(t){t.forEach(function(e){return e.contractBalances=new Map}),e.setState({tokens:t})});Promise.all([a,n,t]).then(function(){e.loadBalances()})}},{key:"getClaimBackUrl",value:function(e,t){if(t<=0)return"";if("ERC20 contract"===e)return"";var a=this.state.snippets.find(function(t){return String(t.contract)===e});return a?a.url:""}},{key:"loadBalances",value:function(){console.log("Load balances "+this.state.walletAddress);var e=this;e.state.tokens.map(function(t,a){return e.state.snippets.map(function(n){return console.log(n),e.getContractBalances(t.address,e.state.walletAddress,n).then(function(t){e.setState(function(e){e.tokens[a].contractBalances.set(n.contract,t)})})}).concat(e.getBalance(t.address,a).then(function(t){e.setState(function(e){e.tokens[a].contractBalances.set("ERC20 contract",t)})}))}).forEach(function(t,a){Promise.all(t).then(function(){console.log("Load balances completed"),e.forceUpdate()})})}},{key:"loadWalletAddress",value:function(){return new Promise(function(e,t){var a=function(){new y.a(window.web3.currentProvider).eth.getAccounts(function(t,a){e(a[0])})};window.web3?a():setTimeout(a,500)})}},{key:"loadTokens",value:function(){return v.a.get("https://safe-relay.gnosis.pm/api/v1/tokens/?limit=5").then(function(e){return[x].concat(e.data.results)})}},{key:"getBalance",value:function(e,t){var a=new(new y.a(window.web3.currentProvider).eth.Contract)(w,e);return a.methods.balanceOf(this.state.walletAddress).call().then(function(){var e=Object(m.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.methods.decimals.call();case 2:return n=e.sent,e.abrupt("return",t/Math.pow(10,n));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}},{key:"getContractBalances",value:function(e,t,a){var n=new y.a(window.web3.currentProvider);return new Function("web3","tokenAddress","accountAddress",a.code)(n,e,t)}},{key:"resolveCustomWalletAddress",value:function(){var e=Object(m.a)(i.a.mark(function e(t){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(-1===t.indexOf(".")){e.next=8;break}return a=new y.a(window.web3.currentProvider),e.next=4,a.eth.ens.getAddress(t);case 4:if((t=e.sent)&&"0x0000000000000000000000000000000000000000"!==t){e.next=8;break}return alert("Invalid ENS name"),e.abrupt("return");case 8:this.state.walletAddress=t,this.setState(function(e){e.tokens.forEach(function(e){return e.contractBalances=new Map})}),this.forceUpdate(),this.loadBalances();case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.tokens;return l.a.createElement("div",null,l.a.createElement("div",{className:"modal fade",id:"QR",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLongTitle","aria-hidden":"true"},l.a.createElement("div",{className:"modal-dialog",role:"document"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("div",{className:"modal-header"},l.a.createElement("h5",{className:"modal-title",id:"exampleModalLongTitle"},"Scan your Address"),l.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},l.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),l.a.createElement("div",{className:"modal-body text-center"},l.a.createElement(k.a,{delay:300,onError:this.handleError,onScan:this.handleScan}))))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col col-12"},l.a.createElement("h1",{className:"text-center"},"Where is my money?"),l.a.createElement("div",{className:"text-center"},l.a.createElement("img",{src:"./img/eyes.gif",className:"rounded",width:"200px",alt:"eyes"})))),l.a.createElement("br",null),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"text-center"},l.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.resolveCustomWalletAddress(e.state.customWalletAddress)}},l.a.createElement("label",null,"Wallet Address:",l.a.createElement("input",{type:"text",style:{width:"400px"},onChange:function(t){return e.setState({customWalletAddress:t.target.value})},value:this.state.customWalletAddress,placeholder:"Enter address or ENS name"})),"\xa0",l.a.createElement("input",{type:"submit",value:"Go"}),"\xa0",l.a.createElement("button",{type:"button","data-toggle":"modal","data-target":"#QR"},"Scan QR"))))),l.a.createElement("div",{className:"row mt-3"},l.a.createElement("div",{className:"col col-6",style:{paddingRight:"20px",borderRight:"1px solid #ccc"}},l.a.createElement("h5",null,"Liquid"),l.a.createElement("table",{className:"table table-hover"},l.a.createElement("tbody",null,t.length<=0?l.a.createElement("tr",null,l.a.createElement("td",null,"Loading Tokens")):t.map(function(t){return l.a.createElement("tr",{key:t.symbol},l.a.createElement("td",null,t.symbol),l.a.createElement("td",null,Array.from(t.contractBalances.values()).reduce(function(e,t){return e+t},0)),l.a.createElement("td",null,l.a.createElement("button",{type:"button",className:"btn btn-outline-secondary btn-sm","data-toggle":"modal","data-target":"#where".concat(t.symbol)},"Where?"),l.a.createElement("div",{className:"modal fade",id:"where".concat(t.symbol),tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLongTitle","aria-hidden":"true"},l.a.createElement("div",{className:"modal-dialog",role:"document"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("div",{className:"modal-header"},l.a.createElement("h5",{className:"modal-title",id:"exampleModalLongTitle"},"Where is my ",t.symbol,"?"),l.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},l.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),l.a.createElement("div",{className:"modal-body"},l.a.createElement("table",{className:"table table-hover"},l.a.createElement("tbody",null," ",Array.from(t.contractBalances.entries()).map(function(t,a){return l.a.createElement("tr",{key:"balance".concat(t[0])},l.a.createElement("td",null,t[0]),l.a.createElement("td",null,t[1]),l.a.createElement("td",null,e.getClaimBackUrl(t[0],t[1])?l.a.createElement("a",{href:e.getClaimBackUrl(t[0],t[1]),target:"_blank",rel:"noopener noreferrer"},"Claim back!"):"-"))}),l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"Total"),l.a.createElement("th",{scope:"col"},Array.from(t.contractBalances.values()).reduce(function(e,t){return e+t},0)),l.a.createElement("th",{scope:"col"}))))),l.a.createElement("div",{className:"modal-footer"},l.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close")))))))})))),l.a.createElement("div",{className:"col col-6"},l.a.createElement("h5",null,"Illiquid / locked"),l.a.createElement("table",{className:"table table-hover"},l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,"todo")))))),l.a.createElement("div",{className:"row mt-3"},l.a.createElement("div",{className:"col col-12  text-center"},l.a.createElement("a",{className:"btn btn-secondary",href:"/create",role:"button"},"Manage dapps"))))}}]),t}(n.Component),C=a(226),S=a.n(C),B=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(a=Object(E.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(l)))).state={snippets:[],intervalIsSet:!1,id:0},a.getDataFromDb=function(){return fetch("http://localhost:3001/api/getSnippets").then(function(e){return e.json()}).then(function(e){return a.setState({snippets:e.data})})},a.putDataToDB=function(e,t,a,n){v.a.post("http://localhost:3001/api/putSnippet",{contract:e,code:t,url:a,isLiquid:n}).then(function(){window.location.reload()})},a.upvote=function(e){localStorage.setItem(e._id,!0),v.a.post("api/upvote",{id:e._id}),e.upvotes++,a.forceUpdate()},a.downvote=function(e){localStorage.setItem(e._id,!0),v.a.post("api/downvote",{id:e._id}),e.downvotes++,a.forceUpdate()},a.toggleSnippet=function(e){a.setState(function(t){t.snippets[e].open=!t.snippets[e].open}),a.forceUpdate()},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.getDataFromDb()}},{key:"render",value:function(){var e=this,t=this.state.snippets;return l.a.createElement("div",null,l.a.createElement("a",{className:"btn btn-secondary",href:"/",role:"button"},"Back to main"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col col-12"},l.a.createElement("h2",{className:"text-center"},"Manage dapps"))),l.a.createElement("div",{className:"row mt-3"},l.a.createElement("div",{className:"col col-12"},l.a.createElement("table",{className:"table table-hover"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"Dapp"),l.a.createElement("th",{scope:"col"},"Code"),l.a.createElement("th",{scope:"col"},"URL"),l.a.createElement("th",{scope:"col"},"Votes"))),l.a.createElement("tbody",null,t.length<=0?l.a.createElement("tr",null,l.a.createElement("td",null,"NO DB ENTRIES YET")):t.map(function(t,a){return l.a.createElement("tr",{key:a},l.a.createElement("td",null,t.contract),l.a.createElement("td",null,l.a.createElement("button",{type:"button",className:"btn btn-outline-secondary","data-toggle":"modal","data-target":"#showCode".concat(a)},"Show code"),l.a.createElement("div",{className:"modal fade",id:"showCode".concat(a),tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLongTitle","aria-hidden":"true"},l.a.createElement("div",{className:"modal-dialog",role:"document"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("div",{className:"modal-header"},l.a.createElement("h5",{className:"modal-title",id:"exampleModalLongTitle"},"Code for ",t.contract),l.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},l.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),l.a.createElement("div",{className:"modal-body"},l.a.createElement(S.a,{className:"js"},t.code)),l.a.createElement("div",{className:"modal-footer"},l.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close")))))),l.a.createElement("td",null,l.a.createElement("a",{href:t.url,target:"_blank",rel:"noopener noreferrer"},t.url)),l.a.createElement("td",null,l.a.createElement("button",{type:"button",class:"btn btn-link",onClick:function(){return e.upvote(t)},disabled:!!localStorage.getItem(t._id)},l.a.createElement("span",{role:"img"},"\ud83d\udc4d"),l.a.createElement("span",null,t.upvotes," ")),l.a.createElement("button",{type:"button",class:"btn btn-link",onClick:function(){return e.downvote(t)},disabled:!!localStorage.getItem(t._id)},l.a.createElement("span",{role:"img"},"\ud83d\udc4e"),l.a.createElement("span",null,t.downvotes," "))))}))))),l.a.createElement("button",{type:"button",className:"btn btn-primary","data-toggle":"modal","data-target":"#addDapp"},"Add dapp"),l.a.createElement("div",{className:"modal fade",id:"addDapp",tabIndex:"-1",role:"dialog","aria-labelledby":"addDappTitle","aria-hidden":"true"},l.a.createElement("div",{className:"modal-dialog",role:"document"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("div",{className:"modal-header"},l.a.createElement("h5",{className:"modal-title",id:"addDappTitle"},"Add new dapp"),l.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},l.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),l.a.createElement("div",{className:"modal-body"},l.a.createElement("h6",null,"Contract Name:"),l.a.createElement("input",{type:"text",className:"form-control",id:"contractInput",placeholder:"Name of dapp"}),l.a.createElement("br",null),l.a.createElement("h6",null,"URL:"),l.a.createElement("input",{type:"text",className:"form-control",id:"urlInput",placeholder:"URL of dapp"}),l.a.createElement("br",null),l.a.createElement("h6",null,"Code:"),l.a.createElement("textarea",{rows:"20",id:"codeInput",placeholder:"Script to fetch balances",className:"form-control"}),l.a.createElement("small",{id:"codeHelp",class:"form-text text-muted"},"Your code must return a promise with the balance. You have the following input objects available: ",l.a.createElement("code",null,"web3"),", ",l.a.createElement("code",null,"tokenAddress"),", ",l.a.createElement("code",null,"accountAddress"),"."),l.a.createElement("br",null),l.a.createElement("div",{class:"form-check"},l.a.createElement("input",{class:"form-check-input",type:"checkbox",id:"isLiquidInput",value:"true"}),l.a.createElement("label",{class:"form-check-label",for:"isLiquidInput"},"is locked (illiquid)"))),l.a.createElement("div",{className:"modal-footer"},l.a.createElement("button",{type:"submit",className:"btn btn-primary","data-dismiss":"modal",onClick:function(){e.putDataToDB(document.getElementById("contractInput").value,document.getElementById("codeInput").value,document.getElementById("urlInput").value,!document.getElementById("isLiquidInput").checked)}},"Save"),l.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close"))))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(r.a,null,l.a.createElement(s.c,null,l.a.createElement(s.a,{exact:!0,path:"/",component:A}),l.a.createElement(s.a,{path:"/create",component:B}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[230,1,2]]]);
//# sourceMappingURL=main.cd339d78.chunk.js.map